// Code generated by gs-http-gen compiler. DO NOT EDIT.

package proto

import (
	"encoding/json"
	"fmt"
	"net/http"
	"net/url"
	"strconv"
	"strings"

	"github.com/lvan100/golib/errutil"
)

var _ = json.Marshal
var _ = strings.Contains
var _ = http.NewServeMux
var _ = strconv.FormatInt

// years
const MAX_AGE int64 = 150

const MIN_AGE int64 = 18

const DEFAULT_VIP bool = false

const DEFAULT_ROLE string = "user"

const DEFAULT_PAGE int64 = 1

const DEFAULT_PAGE_SIZE int64 = 20

const MAX_PAGE_SIZE int64 = 100

const SALARY_MIN float64 = 0.0

const SALARY_MAX float64 = 1000000.0

// Standard error codes
type ErrCode int32

const (
	ErrCode_ERR_OK            ErrCode = 0
	ErrCode_PARAM_ERROR       ErrCode = 1003
	ErrCode_NOT_FOUND         ErrCode = 4004
	ErrCode_PERMISSION_DENIED ErrCode = 4003
	ErrCode_INTERNAL_ERROR    ErrCode = 5000
)

var (
	ErrCode_name = map[ErrCode]string{
		0:    "ERR_OK",
		1003: "PARAM_ERROR",
		4004: "NOT_FOUND",
		4003: "PERMISSION_DENIED",
		5000: "INTERNAL_ERROR",
	}
	ErrCode_value = map[string]ErrCode{
		"ERR_OK":            0,
		"PARAM_ERROR":       1003,
		"NOT_FOUND":         4004,
		"PERMISSION_DENIED": 4003,
		"INTERNAL_ERROR":    5000,
	}
	ErrCode_message = map[ErrCode]string{
		0:    "ERR_OK",
		1003: "param error",
		4004: "NOT_FOUND",
		4003: "PERMISSION_DENIED",
		5000: "INTERNAL_ERROR",
	}
)

// OneOfErrCode is usually used for validation.
func OneOfErrCode(i ErrCode) bool {
	_, ok := ErrCode_name[i]
	return ok
}

// OneOfErrCodeAsString is usually used for validation.
func OneOfErrCodeAsString(i ErrCodeAsString) bool {
	_, ok := ErrCode_name[ErrCode(i)]
	return ok
}

// ErrCodeAsString wraps ErrCode to encode/decode as a JSON string.
type ErrCodeAsString ErrCode

// MarshalJSON implements custom JSON encoding for the enum as a string.
func (x ErrCodeAsString) MarshalJSON() ([]byte, error) {
	if s, ok := ErrCode_name[ErrCode(x)]; ok {
		return []byte(fmt.Sprintf("\"%s\"", s)), nil
	}
	return nil, errutil.Explain(nil, "invalid ErrCode: %d", x)
}

// UnmarshalJSON implements custom JSON decoding for the enum from a string.
func (x *ErrCodeAsString) UnmarshalJSON(data []byte) error {
	str := strings.Trim(string(data), "\"")
	if v, ok := ErrCode_value[str]; ok {
		*x = ErrCodeAsString(v)
		return nil
	}
	return errutil.Explain(nil, "invalid ErrCode value: %q", str)
}

// Manager seniority levels
type ManagerLevel int32

const (
	ManagerLevel_JUNIOR ManagerLevel = 1
	ManagerLevel_MIDDLE ManagerLevel = 2
	ManagerLevel_SENIOR ManagerLevel = 3
)

var (
	ManagerLevel_name = map[ManagerLevel]string{
		1: "JUNIOR",
		2: "MIDDLE",
		3: "SENIOR",
	}
	ManagerLevel_value = map[string]ManagerLevel{
		"JUNIOR": 1,
		"MIDDLE": 2,
		"SENIOR": 3,
	}
)

// OneOfManagerLevel is usually used for validation.
func OneOfManagerLevel(i ManagerLevel) bool {
	_, ok := ManagerLevel_name[i]
	return ok
}

// OneOfManagerLevelAsString is usually used for validation.
func OneOfManagerLevelAsString(i ManagerLevelAsString) bool {
	_, ok := ManagerLevel_name[ManagerLevel(i)]
	return ok
}

// ManagerLevelAsString wraps ManagerLevel to encode/decode as a JSON string.
type ManagerLevelAsString ManagerLevel

// MarshalJSON implements custom JSON encoding for the enum as a string.
func (x ManagerLevelAsString) MarshalJSON() ([]byte, error) {
	if s, ok := ManagerLevel_name[ManagerLevel(x)]; ok {
		return []byte(fmt.Sprintf("\"%s\"", s)), nil
	}
	return nil, errutil.Explain(nil, "invalid ManagerLevel: %d", x)
}

// UnmarshalJSON implements custom JSON decoding for the enum from a string.
func (x *ManagerLevelAsString) UnmarshalJSON(data []byte) error {
	str := strings.Trim(string(data), "\"")
	if v, ok := ManagerLevel_value[str]; ok {
		*x = ManagerLevelAsString(v)
		return nil
	}
	return errutil.Explain(nil, "invalid ManagerLevel value: %q", str)
}

// Company departments
type Department int32

const (
	Department_ENGINEERING Department = 1
	Department_MARKETING   Department = 2
	Department_SALES       Department = 3
	Department_HR          Department = 4
	Department_FINANCE     Department = 5
)

var (
	Department_name = map[Department]string{
		1: "ENGINEERING",
		2: "MARKETING",
		3: "SALES",
		4: "HR",
		5: "FINANCE",
	}
	Department_value = map[string]Department{
		"ENGINEERING": 1,
		"MARKETING":   2,
		"SALES":       3,
		"HR":          4,
		"FINANCE":     5,
	}
)

// OneOfDepartment is usually used for validation.
func OneOfDepartment(i Department) bool {
	_, ok := Department_name[i]
	return ok
}

// OneOfDepartmentAsString is usually used for validation.
func OneOfDepartmentAsString(i DepartmentAsString) bool {
	_, ok := Department_name[Department(i)]
	return ok
}

// DepartmentAsString wraps Department to encode/decode as a JSON string.
type DepartmentAsString Department

// MarshalJSON implements custom JSON encoding for the enum as a string.
func (x DepartmentAsString) MarshalJSON() ([]byte, error) {
	if s, ok := Department_name[Department(x)]; ok {
		return []byte(fmt.Sprintf("\"%s\"", s)), nil
	}
	return nil, errutil.Explain(nil, "invalid Department: %d", x)
}

// UnmarshalJSON implements custom JSON decoding for the enum from a string.
func (x *DepartmentAsString) UnmarshalJSON(data []byte) error {
	str := strings.Trim(string(data), "\"")
	if v, ok := Department_value[str]; ok {
		*x = DepartmentAsString(v)
		return nil
	}
	return errutil.Explain(nil, "invalid Department value: %q", str)
}

// Pagination request and response
type PageReq struct {
	Page *int64 `json:"page,omitempty" query:"page" validate:"required"`
	Size *int64 `json:"size,omitempty" query:"size" validate:"required"`
}

// Address & Contact info
type Address struct {
	City       *string `json:"city,omitempty" form:"city"`
	Street     *string `json:"street,omitempty" form:"street"`
	PostalCode *string `json:"postalCode,omitempty" form:"postalCode"`
}

// Validate checks field values using generated validation expressions.
func (x *Address) Validate() (err error) {
	return
}

type ContactInfo struct {
	Email   *string  `json:"email,omitempty" form:"email" validate:"required"`
	Phone   *string  `json:"phone,omitempty" form:"phone"`
	Address *Address `json:"address,omitempty" form:"address"`
}

// Validate checks field values using generated validation expressions.
func (x *ContactInfo) Validate() (err error) {
	if x.Email == nil {
		err = errutil.Stack(err, "\"ContactInfo.Email\" is required")
	}
	if x.Email != nil {
		if !(Email(*x.Email)) {
			err = errutil.Stack(err, "validate failed on \"ContactInfo.Email\"")
		}
	}
	return
}

// Department info
type DepartmentInfo struct {
	Dept     *Department `json:"dept,omitempty" form:"dept"`
	DeptName *string     `json:"deptName,omitempty" form:"deptName"`
}

// Validate checks field values using generated validation expressions.
func (x *DepartmentInfo) Validate() (err error) {
	return
}

// Manager entity definition
type Manager struct {
	Id             *string                                 `json:"id,omitempty" form:"id"`
	Name           *string                                 `json:"name,omitempty" form:"name"`
	Age            *int64                                  `json:"age,omitempty" form:"age"`
	Vip            *bool                                   `json:"vip,omitempty" form:"vip"`
	Salary         *float64                                `json:"salary,omitempty" form:"salary"`
	Role           *string                                 `json:"role,omitempty" form:"role"`
	Level          *ManagerLevelAsString                   `json:"level,omitempty" form:"level"`
	DeptInfo       *DepartmentInfo                         `json:"deptInfo,omitempty" form:"deptInfo"`
	Contact        *ContactInfo                            `json:"contact,omitempty" form:"contact"`
	ContactInfos   []*ContactInfo                          `json:"contactInfos,omitempty" form:"contactInfos"`
	ContactInfoV2s [][]*ContactInfo                        `json:"contactInfoV2s,omitempty" form:"contactInfoV2s"`
	ContactInfoV3s [][][]*ContactInfo                      `json:"contactInfoV3s,omitempty" form:"contactInfoV3s"`
	ContactMaps    map[string]*ContactInfo                 `json:"contactMaps,omitempty" form:"contactMaps"`
	ContactMapV2s  map[string][]*ContactInfo               `json:"contactMapV2s,omitempty" form:"contactMapV2s"`
	ContactMapV3s  map[string]map[int64]*ContactInfo       `json:"contactMapV3s,omitempty" form:"contactMapV3s"`
	Extra          map[string]string                       `json:"extra,omitempty" form:"extra"`
	ExtraV2        map[string]map[string]string            `json:"extraV2,omitempty" form:"extraV2"`
	ExtraV3        map[string]map[string]map[string]string `json:"extraV3,omitempty" form:"extraV3"`
	ExtraV4        map[string]map[string][]string          `json:"extraV4,omitempty" form:"extraV4"`
	ExtraV5        map[string][]string                     `json:"extraV5,omitempty" form:"extraV5"`
}

// Single manager by ID
type ManagerReq struct {
	ManagerReqBody
	Id *string `json:"id,omitempty" path:"id"`
}

// QueryForm returns the form values of the object.
func (x *ManagerReq) QueryForm() (string, error) {
	return "", nil
}

// Binding extracts non-body values (path, query) from *http.Request.
func (x *ManagerReq) Bind(r *http.Request) error {
	values, err := url.ParseQuery(r.URL.RawQuery)
	if err != nil {
		return errutil.Explain(err, "parse query error")
	}
	if len(values) == 0 {
		return nil
	}
	return err
}

// Validate checks field values using generated validation expressions.
func (x *ManagerReq) Validate() (err error) {
	if validateErr := x.ManagerReqBody.Validate(); validateErr != nil {
		err = errutil.Stack(err, "validate failed on \"ManagerReq\": %w", validateErr)
	}
	return
}

type ManagerReqBody struct {
}

// EncodeForm encodes the object to form data.
func (x *ManagerReqBody) EncodeForm() (string, error) {
	return "", nil
}

// DecodeForm decodes the object from form data.
func (x *ManagerReqBody) DecodeForm(b []byte) error {
	return nil
}

// Validate checks field values using generated validation expressions.
func (x *ManagerReqBody) Validate() (err error) {
	return
}

// Create new manager
type CreateManagerReq struct {
	CreateManagerReqBody
}

// QueryForm returns the form values of the object.
func (x *CreateManagerReq) QueryForm() (string, error) {
	return "", nil
}

// Binding extracts non-body values (path, query) from *http.Request.
func (x *CreateManagerReq) Bind(r *http.Request) error {
	return nil
}

// Validate checks field values using generated validation expressions.
func (x *CreateManagerReq) Validate() (err error) {
	if validateErr := x.CreateManagerReqBody.Validate(); validateErr != nil {
		err = errutil.Stack(err, "validate failed on \"CreateManagerReq\": %w", validateErr)
	}
	return
}

type CreateManagerReqBody struct {
	Name     *string               `json:"name,omitempty" form:"name"`
	Age      *int64                `json:"age,omitempty" form:"age"`
	Vip      *bool                 `json:"vip,omitempty" form:"vip"`
	Salary   *float64              `json:"salary,omitempty" form:"salary"`
	Role     *string               `json:"role,omitempty" form:"role"`
	Level    *ManagerLevelAsString `json:"level,omitempty" form:"level"`
	DeptInfo *DepartmentInfo       `json:"deptInfo,omitempty" form:"deptInfo"`
	Contact  *ContactInfo          `json:"contact,omitempty" form:"contact"`
}

// Validate checks field values using generated validation expressions.
func (x *CreateManagerReqBody) Validate() (err error) {
	if x.Name != nil {
		if !(len(*x.Name) > 0 && len(*x.Name) <= 64) {
			err = errutil.Stack(err, "validate failed on \"CreateManagerReq.Name\"")
		}
	}
	if x.Age != nil {
		if !(*x.Age >= MIN_AGE && *x.Age <= MAX_AGE) {
			err = errutil.Stack(err, "validate failed on \"CreateManagerReq.Age\"")
		}
	}
	if x.Salary != nil {
		if !(*x.Salary >= SALARY_MIN && *x.Salary <= SALARY_MAX) {
			err = errutil.Stack(err, "validate failed on \"CreateManagerReq.Salary\"")
		}
	}
	if x.Contact != nil {
		if validateErr := x.Contact.Validate(); validateErr != nil {
			err = errutil.Stack(err, "validate failed on \"CreateManagerReq.Contact\": %w", validateErr)
		}
	}
	return
}

// Update existing manager
type UpdateManagerReq struct {
	UpdateManagerReqBody
	ID *string `json:"id,omitempty" path:"id"`
}

// QueryForm returns the form values of the object.
func (x *UpdateManagerReq) QueryForm() (string, error) {
	return "", nil
}

// Binding extracts non-body values (path, query) from *http.Request.
func (x *UpdateManagerReq) Bind(r *http.Request) error {
	values, err := url.ParseQuery(r.URL.RawQuery)
	if err != nil {
		return errutil.Explain(err, "parse query error")
	}
	if len(values) == 0 {
		return nil
	}
	return err
}

// Validate checks field values using generated validation expressions.
func (x *UpdateManagerReq) Validate() (err error) {
	if validateErr := x.UpdateManagerReqBody.Validate(); validateErr != nil {
		err = errutil.Stack(err, "validate failed on \"UpdateManagerReq\": %w", validateErr)
	}
	return
}

type UpdateManagerReqBody struct {
	Name     *string         `json:"name,omitempty" form:"name"`
	Age      *int64          `json:"age,omitempty" form:"age"`
	Vip      *bool           `json:"vip" form:"vip"`
	Salary   *float64        `json:"salary,omitempty" form:"salary"`
	Role     *string         `json:"role,omitempty" form:"role"`
	Level    *ManagerLevel   `json:"level,omitempty" form:"level"`
	DeptInfo *DepartmentInfo `json:"dept_info,omitempty" form:"dept_info"`
	Contact  *ContactInfo    `json:"contact,omitempty" form:"contact"`
}

// Validate checks field values using generated validation expressions.
func (x *UpdateManagerReqBody) Validate() (err error) {
	if x.Age != nil {
		if !(*x.Age >= MIN_AGE && *x.Age <= MAX_AGE) {
			err = errutil.Stack(err, "validate failed on \"UpdateManagerReq.Age\"")
		}
	}
	if x.Salary != nil {
		if !(*x.Salary >= SALARY_MIN && *x.Salary <= SALARY_MAX) {
			err = errutil.Stack(err, "validate failed on \"UpdateManagerReq.Salary\"")
		}
	}
	if x.Contact != nil {
		if validateErr := x.Contact.Validate(); validateErr != nil {
			err = errutil.Stack(err, "validate failed on \"UpdateManagerReq.Contact\": %w", validateErr)
		}
	}
	return
}

// Paginated manager query
type ListManagersByPageReq struct {
	ListManagersByPageReqBody
	Page     *int64        `json:"page,omitempty" query:"page" validate:"required"`
	Size     *int64        `json:"size,omitempty" query:"size" validate:"required"`
	Keyword  []string      `json:"keyword,omitempty" query:"keyword"`
	Dept     *Department   `json:"dept,omitempty" query:"dept"`
	MinLevel *ManagerLevel `json:"minLevel,omitempty" query:"minLevel"`
	Vip      *bool         `json:"vip,omitempty" query:"vip"`
}

// QueryForm returns the form values of the object.
func (x *ListManagersByPageReq) QueryForm() (string, error) {
	m := make(url.Values)
	if x.Page != nil {
		m.Add("page", strconv.FormatInt(int64(*x.Page), 10))
	}
	if x.Size != nil {
		m.Add("size", strconv.FormatInt(int64(*x.Size), 10))
	}
	for i := range len(x.Keyword) {
		m.Add("keyword", x.Keyword[i])
	}
	if x.Dept != nil {
		m.Add("dept", strconv.FormatInt(int64(*x.Dept), 10))
	}
	if x.MinLevel != nil {
		m.Add("minLevel", strconv.FormatInt(int64(*x.MinLevel), 10))
	}
	if x.Vip != nil {
		m.Add("vip", strconv.FormatBool(*x.Vip))
	}
	return m.Encode(), nil
}

// Binding extracts non-body values (path, query) from *http.Request.
func (x *ListManagersByPageReq) Bind(r *http.Request) error {
	values, err := url.ParseQuery(r.URL.RawQuery)
	if err != nil {
		return errutil.Explain(err, "parse query error")
	}
	if len(values) == 0 {
		return nil
	}
	if v, ok := values["page"]; ok {
		if len(v) == 1 {
			if i, parseErr := strconv.ParseInt(v[0], 10, 64); parseErr != nil {
				err = errutil.Stack(err, "parse \"page\" error: %w", parseErr)
			} else {
				x.Page = &i
			}
		} else {
			err = errutil.Stack(err, "invalid value for \"page\"")
		}
	}
	if v, ok := values["size"]; ok {
		if len(v) == 1 {
			if i, parseErr := strconv.ParseInt(v[0], 10, 64); parseErr != nil {
				err = errutil.Stack(err, "parse \"size\" error: %w", parseErr)
			} else {
				x.Size = &i
			}
		} else {
			err = errutil.Stack(err, "invalid value for \"size\"")
		}
	}
	if v, ok := values["keyword"]; ok {
		for _, s := range v {
			var i string
			parseErr := json.Unmarshal([]byte(s), &i)
			if parseErr != nil {
				err = errutil.Stack(err, "json decode error: %w", parseErr)
			}
			x.Keyword = append(x.Keyword, i)
		}
	}
	if v, ok := values["dept"]; ok {
		if len(v) == 1 {
			if i, parseErr := strconv.ParseInt(v[0], 10, 64); parseErr != nil {
				err = errutil.Stack(err, "parse \"dept\" error: %w", parseErr)
			} else {
				if e := Department(i); !OneOfDepartment(e) {
					err = errutil.Stack(err, "invalid value for \"dept\"")
				} else {
					x.Dept = &e
				}
			}
		} else {
			err = errutil.Stack(err, "invalid value for \"dept\"")
		}
	}
	if v, ok := values["minLevel"]; ok {
		if len(v) == 1 {
			if i, parseErr := strconv.ParseInt(v[0], 10, 64); parseErr != nil {
				err = errutil.Stack(err, "parse \"minLevel\" error: %w", parseErr)
			} else {
				if e := ManagerLevel(i); !OneOfManagerLevel(e) {
					err = errutil.Stack(err, "invalid value for \"minLevel\"")
				} else {
					x.MinLevel = &e
				}
			}
		} else {
			err = errutil.Stack(err, "invalid value for \"minLevel\"")
		}
	}
	if v, ok := values["vip"]; ok {
		if len(v) == 1 {
			if i, parseErr := strconv.ParseBool(v[0]); parseErr != nil {
				err = errutil.Stack(err, "parse \"vip\" error: %w", parseErr)
			} else {
				x.Vip = &i
			}
		} else {
			err = errutil.Stack(err, "invalid value for \"vip\"")
		}
	}
	return err
}

// Validate checks field values using generated validation expressions.
func (x *ListManagersByPageReq) Validate() (err error) {
	if x.Page == nil {
		err = errutil.Stack(err, "\"ListManagersByPageReq.Page\" is required")
	}
	if x.Page != nil {
		if !(*x.Page >= 1) {
			err = errutil.Stack(err, "validate failed on \"ListManagersByPageReq.Page\"")
		}
	}
	if x.Size == nil {
		err = errutil.Stack(err, "\"ListManagersByPageReq.Size\" is required")
	}
	if x.Size != nil {
		if !(*x.Size >= 1 && *x.Size <= MAX_PAGE_SIZE) {
			err = errutil.Stack(err, "validate failed on \"ListManagersByPageReq.Size\"")
		}
	}
	if !(len(x.Keyword) <= 5) {
		err = errutil.Stack(err, "validate failed on \"ListManagersByPageReq.Keyword\"")
	}
	if validateErr := x.ListManagersByPageReqBody.Validate(); validateErr != nil {
		err = errutil.Stack(err, "validate failed on \"ListManagersByPageReq\": %w", validateErr)
	}
	return
}

type ListManagersByPageReqBody struct {
}

// EncodeForm encodes the object to form data.
func (x *ListManagersByPageReqBody) EncodeForm() (string, error) {
	return "", nil
}

// DecodeForm decodes the object from form data.
func (x *ListManagersByPageReqBody) DecodeForm(b []byte) error {
	return nil
}

// Validate checks field values using generated validation expressions.
func (x *ListManagersByPageReqBody) Validate() (err error) {
	return
}

// Create / Update / Get responses
type CreateManagerResp struct {
	Errno  *ErrCode `json:"errno,omitempty" form:"errno" validate:"required"`
	Errmsg *string  `json:"errmsg,omitempty" form:"errmsg" validate:"required"`
	Data   *Manager `json:"data,omitempty" form:"data"`
}

type UpdateManagerResp struct {
	Errno  *ErrCode `json:"errno,omitempty" form:"errno" validate:"required"`
	Errmsg *string  `json:"errmsg,omitempty" form:"errmsg" validate:"required"`
	Data   *Manager `json:"data,omitempty" form:"data"`
}

type GetManagerResp struct {
	Errno  *ErrCode `json:"errno,omitempty" form:"errno" validate:"required"`
	Errmsg *string  `json:"errmsg,omitempty" form:"errmsg" validate:"required"`
	Data   *Manager `json:"data,omitempty" form:"data"`
}

type DeleteManagerResp struct {
	Errno  *ErrCode `json:"errno,omitempty" form:"errno" validate:"required"`
	Errmsg *string  `json:"errmsg,omitempty" form:"errmsg" validate:"required"`
	Data   *bool    `json:"data,omitempty" form:"data"`
}

// Paginated response
type ManagersPageData struct {
	Total *int64     `json:"total,omitempty" form:"total"`
	Page  *int64     `json:"page,omitempty" form:"page"`
	Size  *int64     `json:"size,omitempty" form:"size"`
	Items []*Manager `json:"items,omitempty" form:"items"`
}

type ListManagersByPageResp struct {
	Errno  *ErrCode          `json:"errno,omitempty" form:"errno" validate:"required"`
	Errmsg *string           `json:"errmsg,omitempty" form:"errmsg" validate:"required"`
	Data   *ManagersPageData `json:"data,omitempty" form:"data"`
}
