// Code generated by gs-http-gen compiler. DO NOT EDIT.

package proto

import (
	"bytes"
	"context"
	"encoding/json"
	"fmt"
	"net/http"
	"reflect"

	"github.com/go-spring/gs-http-gen/lib/httputil"
	"github.com/go-spring/gs-mock/gsmock"
)

var clientType = reflect.TypeFor[Client]()

// Client is a wrapper struct that embeds ClientInterface.
// It can be used to track or extend the construction process of the client.
type Client struct {
	Target string
}

// Create a new manager
func (c *Client) CreateManager(ctx context.Context, req *CreateManagerReq, opts ...httputil.RequestOption) (*http.Response, *CreateManagerResp, error) {
	if ret, ok := gsmock.InvokeContext(ctx, clientType, "CreateManager", ctx, req, opts); ok {
		return gsmock.Unbox3[*http.Response, *CreateManagerResp, error](ret)
	}

	path := fmt.Sprintf("/managers")
	if s, err := req.QueryForm(); err != nil {
		return nil, nil, err
	} else if s != "" {
		path += "?" + s
	}

	buf := bytes.NewBuffer(nil)
	if err := json.NewEncoder(buf).Encode(req.CreateManagerReqBody); err != nil {
		return nil, nil, err
	}

	r, err := http.NewRequestWithContext(ctx, "POST", path, buf)
	if err != nil {
		return nil, nil, err
	}

	r.Header.Set("Content-Type", "application/json")

	opts = append(opts, httputil.WithTarget(c.Target))
	opts = append(opts, httputil.WithPath("/managers"))
	opts = append(opts, httputil.WithSchema("http"))

	return httputil.JSONResponse[*CreateManagerResp](r, opts...)
}

// Delete a manager
func (c *Client) DeleteManager(ctx context.Context, req *ManagerReq, opts ...httputil.RequestOption) (*http.Response, *DeleteManagerResp, error) {
	if ret, ok := gsmock.InvokeContext(ctx, clientType, "DeleteManager", ctx, req, opts); ok {
		return gsmock.Unbox3[*http.Response, *DeleteManagerResp, error](ret)
	}

	path := fmt.Sprintf("/managers/%v", req.Id)
	if s, err := req.QueryForm(); err != nil {
		return nil, nil, err
	} else if s != "" {
		path += "?" + s
	}

	var buf *bytes.Buffer
	if s, err := req.ManagerReqBody.EncodeForm(); err != nil {
		return nil, nil, err
	} else if s != "" {
		buf = bytes.NewBufferString(s)
	}

	r, err := http.NewRequestWithContext(ctx, "DELETE", path, buf)
	if err != nil {
		return nil, nil, err
	}

	r.Header.Set("Content-Type", "application/x-www-form-urlencoded")

	opts = append(opts, httputil.WithTarget(c.Target))
	opts = append(opts, httputil.WithPath("/managers/{id}"))
	opts = append(opts, httputil.WithSchema("http"))

	return httputil.JSONResponse[*DeleteManagerResp](r, opts...)
}

// Get manager by ID
func (c *Client) GetManager(ctx context.Context, req *ManagerReq, opts ...httputil.RequestOption) (*http.Response, *GetManagerResp, error) {
	if ret, ok := gsmock.InvokeContext(ctx, clientType, "GetManager", ctx, req, opts); ok {
		return gsmock.Unbox3[*http.Response, *GetManagerResp, error](ret)
	}

	path := fmt.Sprintf("/managers/%v", req.Id)
	if s, err := req.QueryForm(); err != nil {
		return nil, nil, err
	} else if s != "" {
		path += "?" + s
	}

	var buf *bytes.Buffer
	if s, err := req.ManagerReqBody.EncodeForm(); err != nil {
		return nil, nil, err
	} else if s != "" {
		buf = bytes.NewBufferString(s)
	}

	r, err := http.NewRequestWithContext(ctx, "GET", path, buf)
	if err != nil {
		return nil, nil, err
	}

	r.Header.Set("Content-Type", "application/x-www-form-urlencoded")

	opts = append(opts, httputil.WithTarget(c.Target))
	opts = append(opts, httputil.WithPath("/managers/{id}"))
	opts = append(opts, httputil.WithSchema("http"))

	return httputil.JSONResponse[*GetManagerResp](r, opts...)
}

// List managers with pagination
func (c *Client) ListManagersByPage(ctx context.Context, req *ListManagersByPageReq, opts ...httputil.RequestOption) (*http.Response, *ListManagersByPageResp, error) {
	if ret, ok := gsmock.InvokeContext(ctx, clientType, "ListManagersByPage", ctx, req, opts); ok {
		return gsmock.Unbox3[*http.Response, *ListManagersByPageResp, error](ret)
	}

	path := fmt.Sprintf("/managers/page")
	if s, err := req.QueryForm(); err != nil {
		return nil, nil, err
	} else if s != "" {
		path += "?" + s
	}

	var buf *bytes.Buffer
	if s, err := req.ListManagersByPageReqBody.EncodeForm(); err != nil {
		return nil, nil, err
	} else if s != "" {
		buf = bytes.NewBufferString(s)
	}

	r, err := http.NewRequestWithContext(ctx, "GET", path, buf)
	if err != nil {
		return nil, nil, err
	}

	r.Header.Set("Content-Type", "application/x-www-form-urlencoded")

	opts = append(opts, httputil.WithTarget(c.Target))
	opts = append(opts, httputil.WithPath("/managers/page"))
	opts = append(opts, httputil.WithSchema("http"))

	return httputil.JSONResponse[*ListManagersByPageResp](r, opts...)
}

// Update manager info
func (c *Client) UpdateManager(ctx context.Context, req *UpdateManagerReq, opts ...httputil.RequestOption) (*http.Response, map[string]any, error) {
	if ret, ok := gsmock.InvokeContext(ctx, clientType, "UpdateManager", ctx, req, opts); ok {
		return gsmock.Unbox3[*http.Response, map[string]any, error](ret)
	}

	path := fmt.Sprintf("/managers/%v", req.ID)
	if s, err := req.QueryForm(); err != nil {
		return nil, nil, err
	} else if s != "" {
		path += "?" + s
	}

	buf := bytes.NewBuffer(nil)
	if err := json.NewEncoder(buf).Encode(req.UpdateManagerReqBody); err != nil {
		return nil, nil, err
	}

	r, err := http.NewRequestWithContext(ctx, "PUT", path, buf)
	if err != nil {
		return nil, nil, err
	}

	r.Header.Set("Content-Type", "application/json")

	opts = append(opts, httputil.WithTarget(c.Target))
	opts = append(opts, httputil.WithPath("/managers/{id}"))
	opts = append(opts, httputil.WithSchema("http"))

	return httputil.JSONResponse[map[string]any](r, opts...)
}
